<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title | escape }}</title>
  <!-- å¼•å…¥ç¬”è®°é¡µé¢çš„ä¸“å± CSS -->
  <link rel="stylesheet" href="{{ '/assets/css/post.css' | relative_url }}">
  <!-- å¼•å…¥ä¸€ä¸ªé€šç”¨çš„ Google å­—ä½“ï¼Œè®©ä¸­è‹±æ–‡æ˜¾ç¤ºæ›´ä¼˜é›… -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  
  <!-- æ·»åŠ é¡¶éƒ¨å¯¼èˆªæ  -->
  <nav class="top-navigation">
    <div class="nav-container">
      <div class="nav-left">
        <a href="{{ '/' | relative_url }}" class="nav-brand">ğŸ“š æˆ‘çš„çŸ¥è¯†åº“</a>
      </div>
      <div class="nav-right">
        <a href="{{ '/' | relative_url }}" class="nav-link">ğŸ  é¦–é¡µ</a>
        <a href="#" class="nav-link" onclick="history.back(); return false;">â¬…ï¸ è¿”å›</a>
      </div>
    </div>
  </nav>

  <div class="post-container">
    <header class="post-header">
      <!-- æ·»åŠ é¢åŒ…å±‘å¯¼èˆª -->
      <div class="breadcrumbs">
        <a href="{{ '/' | relative_url }}">é¦–é¡µ</a>
        <span class="breadcrumb-separator">></span>
        <span class="current-page">{{ page.title | default: "ç¬”è®°è¯¦æƒ…" }}</span>
      </div>
      
      <!-- æ˜¾ç¤ºç¬”è®°çš„æ ‡é¢˜ -->
      <h1 class="post-title">{{ page.title | default: "æ— æ ‡é¢˜ç¬”è®°" }}</h1>
      
      <!-- æ˜¾ç¤ºç¬”è®°çš„å…ƒæ•°æ® -->
      <div class="post-meta">
        {% if page.author %}
          <span class="meta-item">âœï¸ <strong>ä½œè€…:</strong> {{ page.author | join: ', ' | remove: '[[' | remove: ']]' }}</span>
        {% endif %}
        {% if page.created %}
          <span class="meta-item">ğŸ“… <strong>åˆ›å»ºæ—¥æœŸ:</strong> {{ page.created | date: "%Y-%m-%d" }}</span>
        {% endif %}
        {% if page.source %}
          <span class="meta-item">ğŸ”— <strong>æ¥æº:</strong> <a href="{{ page.source }}" target="_blank" rel="noopener noreferrer">ç‚¹å‡»æŸ¥çœ‹</a></span>
        {% endif %}
      </div>
    </header>

    <!-- è¿™é‡Œæ˜¯ç¬”è®° Markdown å†…å®¹è¢«æ¸²æŸ“åçš„åœ°æ–¹ -->
    <article class="post-content">
      {{ content }}
    </article>

    <!-- æ˜¾ç¤ºæ ‡ç­¾ -->
    {% if page.tags %}
      <footer class="post-footer">
        <div class="post-tags">
          <strong>ğŸ·ï¸ æ ‡ç­¾:</strong>
          {% assign tag_list = page.tags | first | split: ' ' %}
          {% for tag in tag_list %}
            {% if tag != "" and tag != "#" %}
              <span class="tag">{{ tag }}</span>
            {% endif %}
          {% endfor %}
        </div>
      </footer>
    {% endif %}
    
    <!-- ç›¸å…³æ–‡ç« æ¨è -->
    {% if site.clippings.size > 1 %}
    <div class="related-posts">
      <h3>ğŸ“– æ›´å¤šæ–‡ç« </h3>
      <ul class="related-list">
        {% assign related_count = 0 %}
        {% for post in site.clippings limit: 10 %}
          {% if post.url != page.url and related_count < 5 %}
            {% assign related_count = related_count | plus: 1 %}
            <li>
              <a href="{{ post.url | relative_url }}">
                <span class="related-title">{{ post.title | default: "æ— æ ‡é¢˜ç¬”è®°" }}</span>
                {% if post.created %}
                  <span class="related-date">{{ post.created | date: "%m-%d" }}</span>
                {% endif %}
              </a>
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    </div>
    {% endif %}
    
    <!-- è¿”å›é¦–é¡µçš„é“¾æ¥ -->
    <div class="back-to-home">
      <a href="{{ '/' | relative_url }}">&larr; è¿”å›çŸ¥è¯†åº“é¦–é¡µ</a>
      <a href="#" onclick="history.back(); return false;" class="back-btn">â†¶ è¿”å›ä¸Šä¸€é¡µ</a>
    </div>
  </div>

  <!-- Mermaid.js é›†æˆ -->
  <script type="module">
    // 1. å¼•å…¥ Mermaid åº“
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    
    // 2. åˆå§‹åŒ–
    mermaid.initialize({ startOnLoad: true });

    // 3. å…¼å®¹ Jekyll çš„ Markdown æ¸²æŸ“
    // Jekyll ä¼šæŠŠ ```mermaid ... ``` æ¸²æŸ“æˆ <pre><code class="language-mermaid">...</code></pre>
    // æˆ‘ä»¬éœ€è¦æ‰¾åˆ°è¿™äº›å—ï¼Œå¹¶æŠŠ class="language-mermaid" æ”¹ä¸º class="mermaid"
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('pre code.language-mermaid').forEach((block) => {
        const preElement = block.parentNode;
        const mermaidContainer = document.createElement('div');
        mermaidContainer.innerHTML = block.textContent;
        mermaidContainer.className = 'mermaid';
        preElement.parentNode.replaceChild(mermaidContainer, preElement);
      });
    });

          // 2. è‡ªåŠ¨ä¸ºæ–‡ç« ä¸­çš„æ‰€æœ‰å›¾ç‰‡æ·»åŠ  Lity ç¯ç®±åŠŸèƒ½
      // éå†æ–‡ç« å†…å®¹åŒºåŸŸçš„æ‰€æœ‰å›¾ç‰‡
      document.querySelectorAll('.post-content img').forEach(function(img) {
        // æ£€æŸ¥å›¾ç‰‡æ˜¯å¦å·²ç»è¢«é“¾æ¥åŒ…è£¹ï¼Œé¿å…é‡å¤æ“ä½œ
        if (img.parentNode.tagName !== 'A') {
          var link = document.createElement('a');
          link.href = img.src;
          // å…³é”®ï¼šæ·»åŠ è¿™ä¸ªå±æ€§ï¼ŒLity åº“ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ç»‘å®šâ€œæ‰“å¼€ç¯ç®±â€äº‹ä»¶
          link.setAttribute('data-lity', ''); 
          
          // å°†æ–°åˆ›å»ºçš„é“¾æ¥æ’å…¥åˆ°å›¾ç‰‡å‰é¢ï¼Œç„¶åå°†å›¾ç‰‡ç§»åŠ¨åˆ°é“¾æ¥å†…éƒ¨
          img.parentNode.insertBefore(link, img);
          link.appendChild(img);
        }
      });
  </script>

</body>
</html>