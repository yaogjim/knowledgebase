---
title: "Agents"
source: "https://langchain-ai.github.io/langgraph/agents/agents/"
author:
published: 2025-07-11
created: 2025-04-22
description: "Build language agents as graphs"
tags:
  - "clippings"
---
[Skip to content](https://langchain-ai.github.io/langgraph/agents/agents/#agents)

## 代理 ¶

## 什么是智能体？ ¶

智能体由三个组件组成：一个大语言模型（LLM）、一组它可以使用的工具以及一个提供指令的提示。

LLM 在循环中运行。在每次迭代中，它选择一个要调用的工具，提供输入，接收结果（一个观察值），并使用该观察值来指导下一个动作。循环继续，直到满足停止条件 —— 通常是当智能体收集到足够的信息来响应用户时。

![image](https://langchain-ai.github.io/langgraph/agents/assets/agent.png)

智能体循环：LLM选择工具并使用其输出来满足用户请求。

## 基本配置 ¶

使用 `create_react_agent` 实例化一个代理：

API 参考：创建 React 代理

```python
from langgraph.prebuilt import create_react_agent

def get_weather(city: str) -> str:  
    """Get weather for a given city."""
    return f"It's always sunny in {city}!"

agent = create_react_agent(
    model="anthropic:claude-3-7-sonnet-latest",  
    tools=[get_weather],  
    prompt="You are a helpful assistant"  
)

# Run the agent
agent.invoke({"messages": "what is the weather in sf"})
```

## LLM 配置 ¶

使用 init\_chat\_model 用特定参数配置一个LLM，比如温度：

API 参考：初始化聊天模型 | 创建 React 代理

有关如何配置LLMs的更多信息，请参阅模型页面。

## 自定义提示 ¶

提示指导LLM如何运行。它们可以是：

- 静态：字符串被解释为系统消息
- 动态：运行时根据输入或配置生成的消息列表

### 静态提示 ¶

定义一个固定的提示字符串或消息列表。

API 参考：创建 React 代理

```python
from langgraph.prebuilt import create_react_agent

agent = create_react_agent(
    model="anthropic:claude-3-7-sonnet-latest",
    tools=[get_weather],
    # A static prompt that never changes
    prompt="Never answer questions about the weather."
)

agent.invoke(
    {"messages": "what is the weather in sf"},
)
```

### 动态提示 ¶

定义一个函数，该函数根据代理的状态和配置返回一个消息列表：

API 参考：AnyMessage | 可运行配置 | 创建 React 代理

```python
from langchain_core.messages import AnyMessage
from langchain_core.runnables import RunnableConfig
from langgraph.prebuilt.chat_agent_executor import AgentState
from langgraph.prebuilt import create_react_agent

def prompt(state: AgentState, config: RunnableConfig) -> list[AnyMessage]:  
    user_name = config.get("configurable", {}).get("user_name")
    system_msg = f"You are a helpful assistant. Address the user as {user_name}."
    return [{"role": "system", "content": system_msg}] + state["messages"]

agent = create_react_agent(
    model="anthropic:claude-3-7-sonnet-latest",
    tools=[get_weather],
    prompt=prompt
)

agent.invoke(
    {"messages": "what is the weather in sf"},
    config={"configurable": {"user_name": "John Smith"}}
)
```

有关更多信息，请参阅上下文页面。

## 内存 ¶

要允许与代理进行多轮对话，在创建代理时需要通过提供 `checkpointer` 来启用持久性。在运行时，需要提供一个包含 `thread_id` （对话（会话）的唯一标识符）的配置：

API 参考：create\_react\_agent | 内存保存器

```python
from langgraph.prebuilt import create_react_agent
from langgraph.checkpoint.memory import InMemorySaver

checkpointer = InMemorySaver()

agent = create_react_agent(
    model="anthropic:claude-3-7-sonnet-latest",
    tools=[get_weather],
    checkpointer=checkpointer  
)

# Run the agent
config = {"configurable": {"thread_id": "1"}}
sf_response = agent.invoke(
    {"messages": "what is the weather in sf"},
    config  
)
ny_response = agent.invoke(
    {"messages": "what about new york?"},
    config
)
```

启用检查点时，它会在提供的检查点数据库中的每一步存储代理状态（如果使用 `InMemorySaver` ，则存储在内存中）。

请注意，在上述示例中，当使用相同的 `thread_id` 第二次调用代理时，第一次对话中的原始消息历史记录会与新的用户输入一起自动包含在内。

有关如何使用内存的更多详细信息，请参阅内存指南。

## 结构化输出 ¶

要生成符合某个模式的结构化响应，请使用 `response_format` 参数。该模式可以使用 `Pydantic` 模型或 `TypedDict` 来定义。结果将通过 `structured_response` 字段进行访问。

API 参考：创建 React 代理